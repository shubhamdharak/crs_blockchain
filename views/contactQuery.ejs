<%if (messages.success) { %>
    <script>toastAlert("Success", "<%= messages.success %>", "alert-success");</script>
    <% } %>
        <%if (messages.error) { %>
            <script>toastAlert("Error", "<%= messages.error %>", "alert-danger");</script>
            <% } %>
                <!-- Side Navagation Bar -->
                <div class="sidebar" style="z-index: 0;">
                    <div class="sidebar-menu">
                        <h5 class="sidebar-title" style="margin-top: 70px;">General</h5>
                        <div class="sidebar-divider"></div>
                        <a href="/Dashboard/bid" class="sidebar-link sidebar-link-with-icon">
                            <span class="sidebar-icon bg-transparent justify-content-start mr-0">
                                <!-- bg-transparent = background-color: transparent, justify-content-start = justify-content: flex-start, mr-0 = margin-right: 0 -->
                                <i class="fa fa-calculator" aria-hidden="true"></i>
                            </span>
                            Bid Section
                        </a>
                        <a href="#modal-8" class="sidebar-link sidebar-link-with-icon">
                            <span class="sidebar-icon bg-transparent justify-content-start mr-0">
                                <!-- bg-transparent = background-color: transparent, justify-content-start = justify-content: flex-start, mr-0 = margin-right: 0 -->
                                <i class="fa fa-newspaper-o" aria-hidden="true"></i>
                            </span>
                            Notification Manager
                        </a>
                        <br />
                        <h5 class="sidebar-title">Productivity</h5>
                        <div class="sidebar-divider"></div>
                        <a href="#modal-2" class="sidebar-link sidebar-link-with-icon">
                            <span class="sidebar-icon bg-primary text-white rounded-circle">
                                <!-- bg-primary = background-color: var(--primary-color), text-white = color: white, rounded-circle = border-radius: 50% -->
                                <i class="fa fa-file-word-o" aria-hidden="true"></i>
                            </span>
                            Launch New Scheme
                        </a>
                        <a href="#modal-7" class="sidebar-link sidebar-link-with-icon">
                            <span class="sidebar-icon bg-success text-dark rounded-circle">
                                <!-- bg-success = background-color: var(--success-color), text-dark = color: var(--lm-base-text-color), rounded-circle = border-radius: 50% -->
                                <i class="fa fa-file-excel-o" aria-hidden="true"></i>
                            </span>
                            Suppliers and Contractors
                        </a>
                        <a href="/transactions" class="sidebar-link sidebar-link-with-icon">
                            <span class="sidebar-icon bg-secondary text-dark rounded-circle">
                                <!-- bg-secondary = background-color: var(--secondary-color), text-dark = color: var(--lm-base-text-color), rounded-circle = border-radius: 50% -->
                                <i class="fa fa-envelope-o" aria-hidden="true"></i>
                            </span>
                            
                            Transaction Manager
                        </a>
                        <a href="/contact" class="sidebar-link sidebar-link-with-icon">
                            <span class="sidebar-icon bg-danger text-white rounded-circle">
                                <!-- bg-danger = background-color: var(--danger-color), text-white = color: white, rounded-circle = border-radius: 50% -->
                                <i class="fa fa-file-powerpoint-o" aria-hidden="true"></i>
                            </span>
                            Help Desk
                        </a>
                    </div>
                </div>
                <!-- Side Navagation End -->

       

                <!-- Modal for displaying contractor and vendors list -->
                <div class="modal ie-scroll-fix" id="modal-7" tabindex="-1" role="dialog">
                
                    <div class="modal-dialog" role="document">
                        <div class="modal-content w-full"> 
                        <a href="#" class="close" role="button" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </a>
                            <h4 class="text-center">List of Members </h4>
                        <div class="dataTable text-center">
                                <!-- Responsive table -->
                                <div class="w-1100 mw-full">
                                <!-- w-400 = width: 40rem (400px), mw-full = max-width: 100% -->
                                <div class="card p-0 bg-very-dark-dm">
                                    <!-- p-0 = padding: 0, bg-very-dark-dm = background-color: var(--dark-color-dark) only in dark mode -->
                                    <div class="table-responsive m-10" >
                                    <table class="table table-inner-bordered stripe " id="myTable">
                                        <thead>
                                        <tr>
                                            <th>#S.No</th>
                                            <th>Name of Members</th>
                                            <th>Position</th>
                                            <th>Mobile No.</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                            <% allUsers.forEach((users, index)=> { %>
                                        <tr>
                                            <th><%= index+1 %></th>
                                            <td><%= users.name %></td>
                                            <td><%= users.accountType %></td>
                                            <td><%= users.mobile %></td>
                                        </tr>
                                            <% }) %>
                                        </tbody>
                                    </table>
                                    </div>
                                </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                <!-- Modal for notification -->
                <div class="modal" id="modal-8" tabindex="-1" role="dialog">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <a href="#" class="btn close" role="button" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </a>
                            <h5 class="modal-title">Add a Notification</h5>
                          
                                <div class="form-group">
                                    <label for="title" class="required">Title</label>
                                    <input type="text" name="title" id="title" class="form-control"
                                        placeholder="Give a title" required="required">
                                </div>
                                
                                <div class="form-group">
                                    <label for="desc" class="required">Description</label>
                                    <textarea class="form-control" name="desc" id="desc"
                                        placeholder="Give detailed description about Notification"></textarea>
                                </div>
                                <button onclick="addNoty()" class="btn btn-secondary btn-block" >Add Notification</button>
                           
                        </div>
                    </div>
                </div>

                <!-- Dashboard Content -->
                <h3 class="ml-10">Recent Query's and Problems </h3>

                <% if (typeof allQuery !='object' ) { %>
                    <div class="card">
                        <h4>No Query so far !</h4>
                    </div>
    

                    <% } else { %>

                    </div>

                        <% allQuery.forEach((query)=> { %>
                            <% if(query._id !=0  ) { %>
                                <div class="card shadow-lg border rounded" id="<%= query._id %>">
                                    <div class="row">
                                        <div class="col-10">
                                            <h2 class="card-title">
                                                <%= query.name.toUpperCase() %>
                                                    
                                            </h2>

                                            <div class="font-size-16">
                                                <%= query.email %>
                                            </div>

                                            <div class="font-size-16">
                                                <%= query.mobile %>
                                            </div>
                                            <div>Query - <%= query.query %>
                                            </div>
                                            <div>Status : <%= query.querySts %> 
                                            </div>
                                            <div class="mt-10">
                                                <details class="collapse-panel w-400 mw-full"> <!-- w-400 = width: 40rem (400px), mw-full = max-width: 100% -->
                                                    <summary class="collapse-header">
                                                      Resolve It
                                                    </summary>
                                                    <div class="collapse-content">
                                                        <form action="/resolveQuery" method="POST">
                                                            <input type="hidden" name="qid" value="<%= query._id %>">
                                                            <textarea class="form-control border" name="solution" placeholder="Write solution here"></textarea>
                                                            <button class="btn btn-success btn-block">send</button>
                                                        </form>
                                                    </div>
                                                  </details>
                                            </div>
                                        </div>
                                        
                                    </div>
                                </div>
                                    <% } %>
                                        <% }) %>
                
                                
                                <% } %>
                                    <!-- Dashboard Content End -->
                                    <script>
                                       
                                        // Add Sidebar to Page
                                        $("#sidebar").addClass("with-sidebar")

                                        

                                        function addNoty() {
                                            const title = $('#modal-8 #title').val();
                                            const description = $('#modal-8 #desc').val();
                                            $.ajax({
                                                type: "POST",
                                                url: "/notification",
                                                data : { title, description },
                                                success: function (response) {
                                                    $('#modal-8').hide();
                                                    toastAlert("Success", "Notification Added", "alert-success");
                                                },
                                                error: function(xhr) {
                                                    toastAlert("Success", "Notification Added", "alert-success");
                                                    $('#modal-8').hide();
                                                }
                                            }) ;
                                        }
                                    </script>
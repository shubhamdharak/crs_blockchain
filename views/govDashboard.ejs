<%if (messages.success) { %>
    <script>toastAlert("Success", "<%= messages.success %>", "alert-success");</script>
<% } %>
<%if (messages.error) { %>
    <script>toastAlert("Error", "<%= messages.error %>", "alert-danger");</script>
<% } %>
    <!-- Side Navagation Bar -->
    <div class="sidebar" style="z-index: 0;">
        <div class="sidebar-menu">
            <h5 class="sidebar-title" style="margin-top: 70px;">General</h5>
            <div class="sidebar-divider"></div>
            <a href="#" class="sidebar-link sidebar-link-with-icon">
                <span class="sidebar-icon bg-transparent justify-content-start mr-0">
                    <!-- bg-transparent = background-color: transparent, justify-content-start = justify-content: flex-start, mr-0 = margin-right: 0 -->
                    <i class="fa fa-calculator" aria-hidden="true"></i>
                </span>
                My Schemes
            </a>
            <a href="#" class="sidebar-link sidebar-link-with-icon">
                <span class="sidebar-icon bg-transparent justify-content-start mr-0">
                    <!-- bg-transparent = background-color: transparent, justify-content-start = justify-content: flex-start, mr-0 = margin-right: 0 -->
                    <i class="fa fa-newspaper-o" aria-hidden="true"></i>
                </span>
                Notification Manager
            </a>
            <br />
            <h5 class="sidebar-title">Productivity</h5>
            <div class="sidebar-divider"></div>
            <a href="#modal-2" class="sidebar-link sidebar-link-with-icon">
                <span class="sidebar-icon bg-primary text-white rounded-circle">
                    <!-- bg-primary = background-color: var(--primary-color), text-white = color: white, rounded-circle = border-radius: 50% -->
                    <i class="fa fa-file-word-o" aria-hidden="true"></i>
                </span>
                Launch New Scheme
            </a>
            <a href="#" class="sidebar-link sidebar-link-with-icon">
                <span class="sidebar-icon bg-success text-dark rounded-circle">
                    <!-- bg-success = background-color: var(--success-color), text-dark = color: var(--lm-base-text-color), rounded-circle = border-radius: 50% -->
                    <i class="fa fa-file-excel-o" aria-hidden="true"></i>
                </span>
                Vendors and Contractors
            </a>
            <a href="#" class="sidebar-link sidebar-link-with-icon">
                <span class="sidebar-icon bg-secondary text-dark rounded-circle">
                    <!-- bg-secondary = background-color: var(--secondary-color), text-dark = color: var(--lm-base-text-color), rounded-circle = border-radius: 50% -->
                    <i class="fa fa-envelope-o" aria-hidden="true"></i>
                </span>
                Transaction Manager
            </a>
            <a href="#" class="sidebar-link sidebar-link-with-icon">
                <span class="sidebar-icon bg-danger text-white rounded-circle">
                    <!-- bg-danger = background-color: var(--danger-color), text-white = color: white, rounded-circle = border-radius: 50% -->
                    <i class="fa fa-file-powerpoint-o" aria-hidden="true"></i>
                </span>
                Verification Desk
            </a>
        </div>
    </div>
    <!-- Side Navagation End -->

    <!-- Modal for add new scheme -->
    <div class="modal" id="modal-2" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <a href="#" class="btn close" role="button" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </a>
            <h5 class="modal-title">Add A New Scheme</h5>
            <form action="/addScheme" method="post">
              <div class="form-group">
                <label for="name" class="required">Name</label>
                <input type="text" name="name" id="name" class="form-control" placeholder="Scheme Name" required="required">
              </div>
              <div class="form-group">
                <label for="cost" class="required">Cost</label>
                <input type="text" id="cost" name="cost" class="form-control" placeholder="Cost of Scheme" required="required">
              </div>
              <div class="form-group">
                <label for="desc" class="required">Description</label>
                <textarea class="form-control" name="description" placeholder="Give detailed description about scheme/ project"></textarea>
              </div>
              <div class="form-group">
                <label for="date" class="required">Date</label>
                <input type="date" id="date" name="date" class="form-control" placeholder="Date" required="required">
              </div>
              <input class="btn btn-danger btn-block" type="submit" value="Launch Scheme">
            </form>
          </div>
        </div>
      </div>

    <!-- Dashboard Content -->
    <% if (typeof allSchemes != 'object') { %>
    <div class="card">
        
        <div class="row">
            <div class="col-10">
                <h2 class="card-title">
                    Scheme Name 1
                    <span class="badge badge-danger">New</span>
                </h2>
                
                <div>Scheme Description</div>
                <div>Name of Vendors who are interested in this Scheme</div>
                <div>Scheme Launched By :</div>
                <div>Time and Budget Estimation :</div>
            </div>
            <div class="col-2">
                <button class="btn btn-success btn-sm" style="margin:10px;" type="button">Delete Scheme</button>
                <button class="btn btn-secondary btn-sm" style="margin:10px;" type="button">Action Buttons</button>
                <button class="btn btn-primary btn-sm" style="margin:10px;" type="button">Update Scheme</button>
            </div>
        </div>
    </div><div class="card">
        <div class="row">
            <div class="col-10">
                <h2 class="card-title">
                    Scheme Name 2
                    <span class="badge badge-danger">New</span>
                </h2>
                
                <div>Scheme Description</div>
                <div>Name of Vendors who are interested in this Scheme</div>
                <div>Scheme Launched By :</div>
                <div>Time and Budget Estimation :</div>
            </div>
            <div class="col-2">
                <button class="btn btn-success btn-sm" style="margin:10px;" type="button">Delete Scheme</button>
                <button class="btn btn-secondary btn-sm" style="margin:10px;" type="button">Action Buttons</button>
                <button class="btn btn-primary btn-sm" style="margin:10px;" type="button">Update Scheme</button>
            </div>
        </div>
    </div>

    <% } else { %>
        
        <% allSchemes.forEach((scheme)=> { %>
    </div><div class="card">
        <div class="row">
            <div class="col-10">
                <h2 class="card-title">
                    <%= scheme.name %>
                    <span class="badge badge-danger">New</span>
                </h2>
                
                <div><%= scheme.description.substring(0,350) %> ....</div>
                <div>Name of Vendors who are interested in this Scheme</div>
                <div>Date of Published : <%= scheme.date %></div>
                <div>Time and Budget Estimation : <%= scheme.cost %></div>
            </div>
            <div class="col-2">
                <button class="btn btn-success btn-sm" id="<%= scheme.id %>" onClick="deleteScheme('<%= scheme.id %>')" style="margin:10px;" type="button">Delete Scheme</button>
                <button class="btn btn-secondary btn-sm" id="<%= scheme.id %>" onClick="" style="margin:10px;" type="button">Action Buttons</button>
                <button class="btn btn-primary btn-sm" id="<%= scheme.id %>" onClick="updateScheme('<%= scheme.id %>')" style="margin:10px;" type="button">Update Scheme</button>
            </div>
        </div>
        <% })  %>
    </div>
    <% } %>
    <!-- Dashboard Content End -->
    <script>
        // Change user Role
        document.getElementById("userRole").innerHTML = "<%= userRole %>"
        // Add Sidebar to Page
        $("#sidebar").addClass("with-sidebar")

        function deleteScheme(id) {
            $.get(`/deleteScheme/${id}`, (data, status)=> {
                console.log(data);
                allSchemes = data
            });
        }
    </script>